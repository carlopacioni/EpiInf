<beast version='2.0'
       namespace='beast.core
                :beast.evolution.tree.coalescent
                :beast.core.util
                :beast.core.parameter
                :beast.evolution.nuc
                :beast.evolution.operators
                :beast.evolution.sitemodel
                :beast.evolution.substitutionmodel
                :beast.evolution.likelihood
                :beast.math.distributions
                :epiinf
                :epiinf.distribs
                :epiinf.models
                :epiinf.util'>



    <input spec='epiinf.util.TreeParserFromFile' id='tree'
           IsLabelledNewick='true'
           adjustTipHeights="false"
           newickFileName='A11.tree'/>

    <input spec='beast.core.parameter.RealParameter' id="originTime">50</input>

    <input spec='SIRModel' id="model">
        <!--psiSamplingProb spec='RealParameter' id="samplingProb" value="0.1"/-->
        <infectionRate spec='RealParameter' id="gamma" value="0.00001" />
        <recoveryRate spec='RealParameter' id="beta" value="0.01" />
        <S0 spec='IntegerParameter' id="S0" value="8000" />
    </input>

    <run spec="MCMC" id="mcmc" chainLength="100000000"> <!--autoOptimize="true"-->
        <state>
            <input name='stateNode' idref='gamma'/>
            <input name='stateNode' idref='beta'/>
            <input name='stateNode' idref='S0'/>
            <input name='stateNode' idref='originTime'/>
        </state>

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution id="coalescent" spec="SMCTreeDensity"
                          model="@model" nParticles="1000">
                <treeEventList spec="TreeEventList" tree="@tree"
                               treeOrigin="@originTime"/>
            </distribution>
            <distribution spec='Prior' x="@gamma">
                <distr spec='OneOnX'/>
            </distribution>
            <distribution spec='Prior' x="@beta">
                <distr spec='OneOnX'/>
            </distribution>
            <distribution spec='Prior' x="@originTime">
                <distr spec='OneOnX'/>
            </distribution>
        </distribution>

        <operator spec='ScaleOperator' parameter="@gamma"  scaleFactor="0.9"
                  weight="1.0"/>
        <operator spec='ScaleOperator' parameter="@beta"  scaleFactor="0.9"
                  weight="1.0"/>
        <operator spec='ScaleOperator' parameter="@originTime"  scaleFactor="0.8"
                  weight="1.0"/>
        <!--operator spec='IntRandomWalkOperator' windowSize="10" parameter="@S0"
                  weight="1.0"/-->

        <logger logEvery="1" fileName="$(filebase).log">
            <log idref="posterior"/>
            <log idref="beta"/>
            <log idref="gamma"/>
            <log idref="originTime"/>
            <log idref="S0"/>
        </logger>
        <!--logger logEvery="10000" fileName="$(filebase).trees">
            <log idref="tree"/>
        </logger-->
        <logger logEvery="100">
            <log idref="posterior"/>
            <log idref="beta"/>
            <log idref="gamma"/>
            <log idref="originTime"/>
            <log idref="S0"/>
        </logger>
    </run>

</beast>
